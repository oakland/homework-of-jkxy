/*! meiqia 2015-09-08 */
var MECHAT={};MECHAT.namespace=function(a){var b=a.split("."),c=MECHAT;for(i="MECHAT"==b[0]?1:0;i<b.length;i++)c[b[i]]=c[b[i]]||{},c=c[b[i]]},MECHAT.namespace("Dom"),MECHAT.Dom.setOpacity=function(a,b){document.all?a.style.filter="alpha(opacity="+b+")":a.style.opacity=b/100},MECHAT.Dom.get=function(a,b){if(b=b||document,a.indexOf("#")>-1)a=a.replace("#",""),a=b.getElementById(a);else if(a.indexOf(".")>-1){var c="*",d=[];if(0!=a.indexOf(".")){var e=a.split(".");c=e[0],a=e[1]}else a=a.replace(".","");for(var f=b.getElementsByTagName(c),g=0,h=f.length;h>g;g++)for(var i=0,j=f[g].className.split(" "),k=j.length;k>i;i++)if(j[i]==a){d.push(f[g]);break}a=d}else a=b.getElementsByTagName(a);return a},MECHAT.Dom.show=function(a){a.style.display="block"},MECHAT.Dom.hide=function(a){a.style.display="none"},MECHAT.Dom.loadScript=function(a){var b=document.createElement("script");b.type="text/javascript",b.src=a,document.body.appendChild(b)},MECHAT.Dom.loadStyle=function(a){var b=document.createElement("style");b.type="text/css";try{b.appendChild(document.createTextNode(a))}catch(c){b.styleSheet.cssText=a}var d=document.getElementsByTagName("head")[0];d.appendChild(b)},MECHAT.Dom.css=function(a,b,c){a.style[b]=c},MECHAT.Dom.rmClass=function(a,b){var c=a.getAttribute("class")||"";c&&(c=c.replace(b,""),a.setAttribute("class",c))},MECHAT.Dom.addClass=function(a,b){var c=a.getAttribute("class")||"";c+=" "+b,a.setAttribute("class",c)},MECHAT.namespace("Broswer"),MECHAT.Broswer={IE6:"msie 6",IE7:"msie 7",IE8:"msie 8",IE9:"msie 9",IE10:"msie 10",IE11:"msie 11",Chrome:"chrome",Firefox:"firefox",Opera:"opera",Safari:"safari",Netscape:"netscape"},MECHAT.Broswer.get=function(){var a="netscape",b=navigator.userAgent.toLowerCase();if(/(msie|firefox|opera|chrome|netscape)\D+(\d[\d.*])/.test(b)){var c=RegExp.$1,d=parseInt(RegExp.$2);a=c,"msie"==c&&(a+=" "+d)}else/version\D+(\d[\d.]*).*safari/.test(b)&&(a="safari");return a},MECHAT.Broswer.isIE=function(){return"ActiveXObject"in window},MECHAT.Broswer.parseQuerystring=function(a){if("string"!=typeof a)return{};if(a=MECHAT.Lang.trim(a),""===a)return{};var b={};try{for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");e[0]&&e[1]&&(b[e[0]]=decodeURIComponent(e[1]))}}catch(f){}return b},MECHAT.Broswer.mc_getReferrer=function(){var a="";if(location.search.length>1){var b=location.search.replace("?",""),c=this.parseQuerystring(b);if(c._realref_)return a=c._realref_}var d=document.getElementById("_realref_");return d&&(a=d.getAttribute("realref")||"",a.length>0)?a:document.referrer},MECHAT.Broswer.isApple=function(){return(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i))&&-1==document.cookie.indexOf("iphone_redirect=false")?!0:!1},MECHAT.Broswer.getPriDomain=function(a){var b="null";("undefined"==typeof a||null==a)&&(a=window.location.href);var c=/.*\:\/\/([^\/]*).*/,d=a.match(c);if("undefined"!=typeof d&&null!=d&&(b=d[1]),b.indexOf(".")>0){var e=b.split("."),f=e.length;f>2&&(b=e[f-2]+"."+e[f-1])}return b},MECHAT.namespace("Event"),MECHAT.Event.getEventTarget=function(){},MECHAT.Event.stopPropagation=function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},MECHAT.Event.on=function(a,b,c){a="string"==typeof a?document.getElementById(a):a,a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent?a.attachEvent("on"+b,c):a["on"+b]=c},MECHAT.Event.defautChnage=function(a,b,c){a.onfocus=function(){var d=a.defaultValue,e="";"div"==b?e=a.innerHTML:"input"==b&&(e=a.value),e=MECHAT.Lang.trim(e),d&&d!=e||(a.defaultValue=e,"div"==b?a.innerHTML="":"input"==b&&(a.value="")),a.setAttribute("style","color:#333;"),c&&c()},a.onblur=function(){var c="";"div"==b?c=a.innerHTML:"input"==b&&(c=a.value),c=MECHAT.Lang.trim(c),(0==c.length||"<br>"==c)&&("div"==b?(a.innerHTML=a.defaultValue,a.setAttribute("style","color:#999;")):"input"==b&&(a.value=a.defaultValue,a.setAttribute("style","color:#999;")))}},MECHAT.namespace("Lang"),MECHAT.Lang={telRegFatory:function(a){return[[RegExp("^"+a+"$","gm"),"<a target='_blank' href=\"tel:$1\">$1</a>"],[RegExp("^"+a+"(\\D)","gm"),"<a target='_blank' href=\"tel:$1\">$1</a>$2"],[RegExp("(\\D)"+a+"$","gm"),"$1<a target='_blank' href=\"tel:$2\">$2</a>"],[RegExp("(\\D)"+a+"(\\D)","gm"),"$1<a target='_blank' href=\"tel:$2\">$2</a>$3"]]},regUrl:[[/((ftp:\/\/)[^\u4E00-\u9FA5 ]+)/gi,"<a target='_blank' href=\"$1\">$1</a>"],[/((http:\/\/|https:\/\/)[^\u4E00-\u9FA5 ]+)/gi,"<a target='_blank' href=\"$1\">$1</a>"],[/((www\.)[^\u4E00-\u9FA5 ]+)/gi,"<a target='_blank' href=\"http://$1\">$1</a>"],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi))[/?#][^\u4E00-\u9FA5， ]+)/gim,"<a target='_blank' href=\"http://$1\">$1</a>"],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi))[/?#])/gim,"<a target='_blank' href=\"http://$1\">$1</a>"],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi)))([0-9\s\u4E00-\u9FA5，]+)/gim,"<a target='_blank' href=\"http://$1\">$1</a>$18"],[/([\.A-Za-z0-9-]+?\.((com)|(net)|(im)|(cn)|(me)|(org)|(edu)|(cc)|(biz)|(info)|(tv)|(co)|(so)|(tel)|(mobi)))$/gim,"<a target='_blank' href=\"http://$1\">$1</a>"]],regTel:[],regEmail:[[/([A-Z0-9\._%+-]+@[A-Z0-9\.-]+\.[A-Z]{2,15})/gim,'<a href="mailto:$1">$1</a>']]},MECHAT.Lang.regTel=MECHAT.Lang.regTel.concat(MECHAT.Lang.telRegFatory("([1]\\d{10})")),MECHAT.Lang.regTel=MECHAT.Lang.regTel.concat(MECHAT.Lang.telRegFatory("([48]00\\d?-?\\d{3,4}-?\\d{3,4})")),MECHAT.Lang.regTel=MECHAT.Lang.regTel.concat(MECHAT.Lang.telRegFatory("(0\\d{2,3}-?\\d{7,8})")),MECHAT.Lang.regTel=MECHAT.Lang.regTel.concat(MECHAT.Lang.telRegFatory("(\\d{8})")),MECHAT.Lang.replace=function(a,b){var c=document.createElement("div");c.innerHTML=a;for(var d in c.childNodes){var e=c.childNodes[d];if(3==e.nodeType){var f=document.createElement("em");f.appendChild(e.cloneNode(!0));var g=f.innerHTML;f.innerHTML=f.innerHTML.replace(b[0],b[1]),f.innerHTML!=g&&c.replaceChild(f,e)}}return c.innerHTML.replace(/\<em\>/g,"").replace(/\<\/em\>/g,"")},MECHAT.Lang.replaceTel=function(a){for(var b in this.regTel)a=this.replace(a,this.regTel[b]);return a},MECHAT.Lang.replaceUrl=function(a){for(var b in this.regUrl)a=this.replace(a,this.regUrl[b]);return a},MECHAT.Lang.replaceEmail=function(a){for(var b in this.regEmail)a=this.replace(a,this.regEmail[b]);return a},MECHAT.Lang.urlTelTrans=function(a){return a=this.replaceEmail(a),a=this.replaceUrl(a),a=this.replaceTel(a)},MECHAT.Lang.trim=function(a){return"undefined"==typeof a?"":(a=a.replace(/^\s*/g,""),a.replace(/\s*$/g,""))},MECHAT.Lang.isNumber=function(a){return!isNaN(a)},MECHAT.Lang.isEmail=function(a){var b=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test(a)},MECHAT.Lang.isQQ=function(a){var b=a.match(/[1-9][0-9]{4,}/);return null==b?!1:!0},MECHAT.Lang.isImg=function(a){var b=a.substring(a.lastIndexOf(".")+1,a.length);return b=b.toLowerCase(),"jpg"!=b&&"jpeg"!=b&&"png"!=b&&"gif"!=b&&"bmp"!=b?!1:!0},MECHAT.Lang.httpReplace=function(a){return/^(f|ht)tps?:\/\//i.test(a)||(a="http://"+a),a},MECHAT.Lang.html_enline=function(a){if("string"!=typeof a)return a;var b="";return a&&0!=a.length?b=a.replace(/\n/g,"<br>"):""},MECHAT.Lang.getSuffix=function(a){return a.substring(a.lastIndexOf(".")+1,a.length)},MECHAT.Lang.isTell=function(a){var b=a.match(/\d{3}-\d{8}|\d{4}-\d{7}/);return null==b?!1:!0},MECHAT.Lang.isPhone=function(a){var b=a.match(/1[3-8]+\d{9}/);return null==b?!1:!0},MECHAT.Lang.isMac=function(){return navigator.userAgent.indexOf("Mac OS X")>0?!0:!1},MECHAT.Lang.html_encode=function(a){var b="";return 0==a.length?"":(b=a.replace(/&/g,"&amp;"),b=b.replace(/</g,"&lt;"),b=b.replace(/>/g,"&gt;"),b=b.replace(/\'/g,"&#39;"),b=b.replace(/\"/g,"&quot;"),b=b.replace(/\n/g,"<br>"))},Date.prototype.format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a},MECHAT.Lang.fromNow=function(a){var b=new Date,c=b.getDate(),d=function(a,b){return a+" "+b};a=new Date(a);var e=(a.getFullYear(),a.getMonth()+1),f=a.getDate(),g=a.getHours(),h=a.getMinutes();g=10>g?"0"+g:g,h=10>h?"0"+h:h;var i=c-f;return 0==i?d("今天",g+":"+h):1==i?d("昨天",g+":"+h):d(e+"月"+f+"日",g+":"+h)},MECHAT.Lang.uc2encode=function(a){var b=escape(a);return b=b.replace(/\%u/g,"\\u")},MECHAT.Lang.objToStr=function(a){var b="";if("object"==typeof a)for(var c in a){var d=a[c];b+=c+"[@]"+d+"[#]"}else b=a;return b},MECHAT.Lang.strToObj=function(a){var b={};if("string"==typeof a&&a.indexOf("#")>0){a=a.split("[#]");for(var c=0,d=a.length;d>c;c++){var e=a[c];e.indexOf("[@]")>0&&(e=e.split("[@]"),b[e[0]]=e[1])}}else b=a;return b},MECHAT.namespace("Obj"),MECHAT.Obj.setProperty=function(a,b){for(var c in b)a.hasOwnProperty(c)&&b[c]&&(a[c]=b[c])},MECHAT.namespace("Cookie"),MECHAT.Cookie={read:function(a,b){a=encodeURIComponent(a)+"=";var c=document.cookie,d=null,e=c.indexOf(a),f=c.indexOf(";",e),f=-1==f?c.length:f;return e>-1&&(d=c.substring(e+a.length,f),b||(d=decodeURIComponent(d))),d},readObj:function(a){var b=this.read(a,!0),c={};if(b){b=b.split("&");for(var d=0,e=b.length;e>d;d++){var f=b[d];f=f.split("="),c[decodeURIComponent(f[0])]=decodeURIComponent(f[1])}}return c},set:function(a,b,c,d,e,f){var g=encodeURIComponent(a)+"=",h=new Array;switch(typeof b){case"object":for(var i in b)i.length>0&&b.hasOwnProperty(i)&&h.push(encodeURIComponent(i)+"="+encodeURIComponent(b[i]));h.length>0&&(g+=h.join("&"));break;default:g+=encodeURIComponent(b)}c||(c=new Date,c.setTime(c.getTime()+7776e6)),c instanceof Date&&(g+="; expires="+c.toGMTString()),d&&(g+="; path="+d),e&&(g+="; domain="+e),f&&(g+="; secure"),document.cookie=g}},MECHAT.pageuuid=1*new Date,MECHAT.namespace("Ajax"),MECHAT.Ajax.createCORSRequest=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject){if("string"!=typeof arguments.callee.activeXString){var a,b,c=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"];for(a=0,b=c.length;b>a;a++)try{new ActiveXObject(c[a]),arguments.callee.activeXString=c[a];break}catch(d){}}return new ActiveXObject(arguments.callee.activeXString)}return xhr},MECHAT.Ajax.makeQuery=function(a){a=a||{};var b=[];a.__=(new Date).getTime();for(var c in a){var d=a[c];b.push(c+"="+encodeURIComponent(d))}var e=b.join("&").replace(/%20/g,"+");return e},MECHAT.Ajax.post=function(a,b,c){var d=this.createCORSRequest(),e=null;try{c.timeout&&(e=setTimeout(function(){c.timeoutBack(),d.abort()},c.timeout)),b.pageuuid=MECHAT.pageuuid;var f=b;"object"==typeof b&&(f=this.makeQuery(b)),d.open("post",a,!0),c.author&&d.setRequestHeader("Authorization",c.author);var g=c.type||"application/x-www-form-urlencoded; charset=UTF-8";d.setRequestHeader("Content-Type",g),d.send(f),"undefined"!=typeof c.success&&(d.onreadystatechange=function(){4==d.readyState&&200==d.status&&(e&&clearTimeout(e),c.success(d.responseText))})}catch(h){e&&clearTimeout(e),c.timeoutBack&&(c.timeoutBack(),d.abort())}},MECHAT.Ajax.get=function(a,b,c){try{var d=this.createCORSRequest();b.pageuuid=MECHAT.pageuuid,a+="?"+this.makeQuery(b),d.open("get",a,!1),"undefined"!=typeof c.success&&(d.onreadystatechange=function(){4==d.readyState&&200==d.status&&c.success(d.responseText)}),d.send(null)}catch(e){c.timeoutBack&&c.timeoutBack()}},MECHAT.Ajax.jsonp=function(a,b,c,d){d&&d.timeout&&setTimeout(function(){d.timeoutBack()},d.timeout),b.pageuuid=MECHAT.pageuuid;var e=this.makeQuery(b)+"&callback="+c,f=document.createElement("script");f.src=a+"?"+e;try{document.body.appendChild(f)}catch(g){}},MECHAT.Ajax.fileUp=function(){},MECHAT.namespace("Drag"),MECHAT.namespace("Ani"),MECHAT.Ani.move=function(a,b,c,d){a.effect||(a.effect={},a.effect.move=0),clearInterval(a.effect.move);var e,c=c||30,f={left:a.offsetLeft,bottom:b.b,top:a.offsetTop,right:b.r},g=a.style,h=new Array;"number"==typeof b.left&&(h.push("left"),e="left"),"number"==typeof b.right&&(h.push("right"),e="right"),"number"==typeof b.bottom&&(h.push("bottom"),e="bottom"),"number"==typeof b.top&&(h.push("top"),e="top"),a.effect.move=setInterval(function(){for(var e=0;e<h.length;e++)f[h[e]]+=(b[h[e]]-f[h[e]])*c/100,g[h[e]]=f[h[e]]+"px";for(var e=0;e<h.length&&Math.round(f[h[e]])==b[h[e]];e++)if(e==h.length-1){for(var e=0;e<h.length;e++)g[h[e]]=b[h[e]]+"px";clearInterval(a.effect.move),d&&d()}},20)},MECHAT.namespace("Color"),MECHAT.Color={blue:["#067ab4","#0c90c2"],gray:["#616161","#797979"],green:["#69b40f","#81c21d"],initial:["#47c1a8","#61cdb8"],red:["#f23f3f","#f45959"],rosered:["#ea4c89","#ee659d"],yellow:["#ff8000","#ff9500"],get:function(a){return a=a.toLowerCase(),this[a]}},function(){var Obj=MECHAT.Obj,Dom=MECHAT.Dom,Ani=MECHAT.Ani,Ajax=MECHAT.Ajax,Lang=MECHAT.Lang,Color=MECHAT.Color,Event=MECHAT.Event,Cookie=MECHAT.Cookie,Broswer=MECHAT.Broswer;Array.prototype.in_array=function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]==a)return!0;return!1},MECHAT.namespace("Page"),MECHAT.Page.CommonCK={save:function(a,b,c){a=this.makeKey(a);var d=null;c&&(d=new Date,d.setTime(d.getTime()+c)),Cookie.set(a,b,d)},read:function(a){return a=this.makeKey(a),Cookie.read(a)},readObj:function(a){return a=this.makeKey(a),Cookie.readObj(a)},makeKey:function(a){return a+"_"+MECHAT.Page.Attr.unitid}},MECHAT.Page.Attr={imgPath:_CONFIG.sHost+"/images/",audioPath:_CONFIG.sHost+"/audio/",chatHtml:_CONFIG.chatHost+"/widget/desktop/index.html",lobegroupHtml:_CONFIG.chatHost+"/widget/desktop/lobegroup.html",screenRes:screen.width+"x"+screen.height,unitid:"",referrer:document.referrer||"",fromPage:Broswer.mc_getReferrer()||"",dialPage:document.referrer||"",inviteUs:"",lp:window.location.href,isbtn:!0,isOnline:!1,btnWords:"在线咨询",from:"",win:"min",ol:"trigger",cookieKey:"MECHAT_CHATCKID",cookieVal:"",colorId:"Initial",colorDf:["#1ABC9C","#33d6b6"],file_token:"",file_name:"",file_token_base64:"",specifyGr:"",specifyUs:"",sendMsgInviteUs:"",blacklist:!1,backUrl:"",email:"",tel:"",username:"",remark:"",custom:"",getMatch:function(a){var b=this.lp.match(a);return null!=b&&b.length>=1?b[1]:""},parseQuerystring:function(a){if(a=a||location.search.replace("?",""),"string"!=typeof a)return{};if(a=Lang.trim(a),""===a)return{};var b={};try{for(var c=a.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");e[0]&&e[1]&&(b[e[0]]=decodeURIComponent(e[1])||"")}}catch(f){}return b},api:{upload:"https://up.qbox.me",upPath:"https://dn-zmec.qbox.me/",chatVisit:"/unit/chatVisit",online:"/mobile/online",getMsgs:"/mobile/getMsgs",poll:"/mobile/poll",sendMsg:"/mobile/sendMsg",leave:"/unit/createleavemsg",button:"/unit/button",getEvents:"/mobile/getEvents",visitPoll:"/visit/poll",uptoken:"/qiniu/image/kuayu/uptoken",uptoken_base64:"/qiniu/image/uptoken",inputting:"/mobile/inputting",lvmsgVisit:"/unit/leavemsgVisit",metadata:"/set/attrs"},getParam:function(){var a=this.parseQuerystring();this.unitid=a.unitid||"",this.cookieVal=a.cookie||"",this.from=a.from||"",this.win=a.win,this.ol=a.ol||this.ol,this.colorId=a.color||this.colorId,this.specifyGr=a.group||a.specifyGr||"",this.specifyUs=a.staff||a.specifyUs||"",this.backUrl=a.url||"",this.cookieVal&&"undefined"!=this.cookieVal||(this.cookieVal=MECHAT.Page.CommonCK.read(this.cookieKey)||""),this.email=a.email||"",this.tel=a.tel||"",this.username=a.username||"",this.remark=a.remark||"",this.custom=a.custom||""},lvmsg_txt:"抱歉，我们现在不在线。<br>请留言，我们会尽快联系你。",lvmsgChecks:{ismail:"true",ismsn:"true",isqq:"true",istel:"true"},urspmsg:"",ursptime:0},MECHAT.Page.Attr.getParam(),MECHAT.Page.uModel={usid:0,uname:"",ulogo:"",utel:"",usavatar:"",ustel:"",usemail:"",usqq:"",usname:"",uurl:"",utime:"",setProperty:function(a){MECHAT.Obj.setProperty(this,a),document.title=this.usname+" - "+this.uname+" 对话中"},save:function(a){MECHAT.Page.CommonCK.save("MECHAT_UModel",a,18e6)},read:function(){return MECHAT.Page.CommonCK.readObj("MECHAT_UModel")}},MECHAT.Page.MetadatModel={realName:"",sex:"",birthday:"",age:"",job:"",avatar:"",comment:"",appUserId:"",appUserName:"",appNickName:"",tel:"",email:"",address:"",QQ:"",weibo:"",weixin:"",appkey:"",from:"",extraParams:"",deviceBrand:"",deviceModel:"",os:"",osVersion:"",resolution:"",networkEnvironment:"",deviceToken:"",appVersion:"",osLanguage:"",osTimezone:"",filterProperty:function(a){var b=this,c=null;for(var d in a)b.hasOwnProperty(d)&&a[d]&&(c=null==c?{}:c,c[d]=a[d]);return c}},MECHAT.Page.Notice={barEl:Dom.get("#notice_bar"),header:Dom.get("#header"),errorBg:"#e66b62",warmingBg:"#f6bc66",create:function(a){var b;try{b=document.createElement('<div class="notice">')}catch(c){b=document.createElement("div"),b.setAttribute("class","notice")}b.innerHTML=a,document.body.appendChild(b);var d=-Math.ceil(b.clientWidth/2);b.setAttribute("style","margin-left:"+d+"px;"),setTimeout(function(){var a=100,c=setInterval(function(){a-=10,Dom.setOpacity(b,a),0>=a&&(clearInterval(c),document.body.removeChild(b))},100)},2e3)},createBar:function(a,b){var c=this,d=c.header.offsetHeight||60;"lobegroup"===MECHAT.Page.Attr.custom&&(d=0),a&&(c.batOut||clearTimeout(c.batOut),Dom.show(c.barEl),c.barEl.innerHTML=a,Ani.move(c.barEl,{top:d},18),b&&(c.batOut=setTimeout(function(){c.hideBar()},b)))},hideBar:function(){var a=this;Ani.move(a.barEl,{top:0},20,function(){Dom.hide(a.barEl)})},warmingBar:function(a,b){Dom.css(this.barEl,"background",this.warmingBg),this.createBar(a,b)},errorBar:function(a,b){Dom.css(this.barEl,"background",this.errorBg),this.createBar(a,b)}},MECHAT.Page.FootTips={layout:Dom.get("#leaveTips"),shadow:Dom.get("div.tips-shadow",this.layout)[0],title:Dom.get("div.tips-title",this.layout)[0],disabled:function(a){a?(Dom.show(this.layout),Dom.show(this.shadow)):(Dom.hide(this.layout),Dom.hide(this.shadow))},txt:function(a){this.disabled(!0),Dom.show(this.title),this.title.innerHTML=a}},MECHAT.Page.Synch={key:"MECHAT_SYNCH",mark:"SY"+(new Date).getTime(),isCheck:!0,lastTime:0,pollData:"POLL-DATA",sendData:"SEND-DATA",save:function(a,b){var c=this,d=b.time||(new Date).getTime(),e={type:a,msgid:b._id||b.msgid||"",fromName:b.fromName||"",content:b.content||"",createdTime:d,mark:c.mark};MECHAT.Page.CommonCK.save(c.key,e,1e4)},check:function(a){var b=this;if(b.isCheck){var c=MECHAT.Page.CommonCK.readObj(b.key);c&&c.mark&&b.mark!=c.mark&&b.lastTime!=c.createdTime&&(a(c),b.lastTime=c.createdTime),setTimeout(function(){b.check(a)},3e3)}}},MECHAT.Page.Loading={element:Dom.get("#online-loading"),show:function(){Dom.show(this.element)},hide:function(){Dom.hide(this.element)}},MECHAT.Page.Wrap={wrap:Dom.get("#wrap"),ul:Dom.get("ul",wrap)[0],msgLoad:'<a title="发送中"><img src="'+MECHAT.Page.Attr.imgPath+'sending.gif" alt="发送中" /></a>',msgYes:'<span class="status-success"></span>',msgNo:'<a title="消息发送失败"><span class="status-error"></span></a>',lineOutTxt:'连接超时，请稍后<a href="javascript:void(0);" onclick="window.mechatReStart();">重试</a>',leaveTipsTxt:'客服已离线，点此 <a href="javascript:void(0);" onclick="window.mechatLeave();">给我们留言</a>',cookie:MECHAT.Cookie,source:"PC",isPoll:!0,lastTime:0,lastTimeTxt:"",getMsgYes:function(a){return a=a?a:(new Date).getTime(),a=new Date(a).format("MM-dd hh:mm"),'<a title="消息发送成功'+a+'"></a>'},scrollBottom:function(){this.wrap.scrollTop=this.ul.offsetHeight},addTxt:function(a,b,c){var d=this;c&&c>0&&(d.lastTime>0&&c-d.lastTime>12e4&&d.tipsMsg({time:c}),d.lastTime=c);var e=b||document.createElement("li");return e.setAttribute("class","clearfix"),a="PC"==d.source?MECHAT.Page.Face.converEmojiByPc(a):MECHAT.Page.Face.converEmoji(a),e.innerHTML=Lang.html_enline(a),d.ul.appendChild(e),d.scrollBottom(),d.timeScroll||(d.timeScroll=setTimeout(function(){d.scrollBottom(),d.timeScroll=null},1500)),e},leaveTips:function(){MECHAT.Page.FootTips.txt(this.leaveTipsTxt)},clientMsg:function(a,b,c){b=b||this.getMsgYes(c),a=MECHAT.Lang.urlTelTrans(a);var d='<div class="msg cli-msg fr"><div class="bgCli msg-con fr"><i class="arrow-br"></i>'+a+'<span class="msg-status">'+b+"</span></div></div>";return"lobegroup"===MECHAT.Page.Attr.custom&&(d='<div class="msg cli-msg"><div class="bgCli msg-con"><i class="arrow-tl"></i>'+a+'<span class="msg-status">'+b+"</span></div></div>"),this.addTxt(d,null,c)},imgMsg:function(a,b,c){b=b||this.msgLoad,c=c||(new Date).getTime();var d="";return d=a?'<div class="msg cli-msg fr"><div class="fr msg-con msg-img-con bgCli"><i class="arrow-br"></i><span class="msg-status">'+this.getMsgYes(c)+'</span><a href="'+a+'" title="点击查看大图" target="_blank"><img src="'+a+'" alt="" class="img-sm"/></a></div></div>':'<div class="msg cli-msg fr"><div class="bgCli msg-con fr"><i class="arrow-br"></i><span class="msg-status">'+b+'</span><div class="img-sending">正在上传图片</div></div></div>',"lobegroup"===MECHAT.Page.Attr.custom&&(d=a?'<div class="msg cli-msg"><div class="msg-con msg-img-con bgCli"><i class="arrow-tl"></i><span class="msg-status">'+this.getMsgYes(c)+'</span><a href="'+a+'" title="点击查看大图" target="_blank"><img src="'+a+'" alt="" class="img-sm"/></a></div></div>':'<div class="msg cli-msg"><div class="bgCli msg-con"><i class="arrow-tl"></i><span class="msg-status">'+b+'</span><div class="img-sending">正在上传图片</div></div></div>'),this.addTxt(d,null,c)},imgPreview:function(a,b){var c=Dom.get("div.msg-con",a)[0];Dom.addClass(c,"msg-img-con");var d=Dom.get("div.img-sending",a)[0];Dom.hide(d);var e=this.createA("javascript:void(0);"),f=this.createImg(b);e.appendChild(f),c.appendChild(e)},createImg:function(a){var b;try{b=document.createElement('<img src="'+a+'" alt="" class="img-sm"/>')}catch(c){b=document.createElement("img"),b.setAttribute("src",a),b.setAttribute("class","img-sm")}return b},createA:function(a){var b;try{b=document.createElement('<a href="'+a+'" target="_blank" title="点击查看大图" class="img-link">')}catch(c){b=document.createElement("a"),b.setAttribute("href",a),b.setAttribute("class","img-link"),b.setAttribute("target","_blank"),b.setAttribute("title","点击查看大图")}return b},sendClientMsg:function(a){if(!(a.length<1)){a=Lang.html_encode(a);var b=this;b.isPoll=!0;var c=b.clientMsg(a,b.msgLoad,(new Date).getTime()),d=Dom.get("span.msg-status",c)[0];MECHAT.Page.Tel.sendMsg(b.source,a,function(c){if(c.success){if(d.innerHTML=b.getMsgYes(),c.usid&&c.usavatar&&c.usname){c.uname=MECHAT.Page.uModel.uname,MECHAT.Page.uModel.setProperty(c),MECHAT.Page.uModel.save(c),MECHAT.Page.Attr.panel&&MECHAT.Page.Attr.panel.setInitInfo();var e={img:c.usavatar,name:c.usname};b.tipsMsg(e),MECHAT.Page.Synch.save("invite",c)}else c.content=a,MECHAT.Page.Synch.save("mb_normal",c);b.answerMsg()}else d.innerHTML=b.msgNo,b.leaveTips(),b.inputOnBlur&&b.inputOnBlur()},3e4,function(){d.innerHTML=b.msgNo,MECHAT.Page.Notice.warmingBar("连接超时,请检查网络",3e3)})}},clientInputting:function(a){var b=this;MECHAT.Page.Tel.inputting(b.source,a)},answerMsg:function(){var a=this;MECHAT.Page.Attr.urspmsg&&MECHAT.Page.Attr.ursptime>0&&(a.clearAnswer(),a.answerTimeout=setTimeout(function(){a.serverMsg(MECHAT.Page.uModel.usname,MECHAT.Page.Attr.urspmsg)},1e3*MECHAT.Page.Attr.ursptime))},clearAnswer:function(){var a=this;a.answerTimeout&&clearTimeout(a.answerTimeout)},serverMsg:function(a,b,c,d){d=parseInt(d),b.indexOf("<img")<0&&(b=MECHAT.Lang.urlTelTrans(b));var e=d>100?d:(new Date).getTime();e=new Date(e).format("yyyy-MM-dd hh:mm");var f='<p class="grey6 f12" title="'+e+'">'+a+'</p><div class="msg ser-msg"><div class="bgSer msg-con"><i class="arrow-tl"></i>'+b+"</div></div>";return"lobegroup"===MECHAT.Page.Attr.custom&&(f='<p class="grey6 f12 text-right" title="'+e+'">'+a+'</p><div class="msg ser-msg fr"><div class="bgSer msg-con"><i class="arrow-br"></i>'+b+"</div></div>"),this.clearAnswer(),this.addTxt(f,c,d)},serverImgMsg:function(a,b,c,d){var e='<a href="'+b+'" target="_blank" title="点击查看大图"><img src="'+b+'" alt="" class="img-sm"/></a>';this.serverMsg(a,e,c,d)},tipsMsg:function(a){var b=this,c="",d="",e="",f="",g="";return a.img&&"PC"!=this.source&&(d='<p class="tc"><img src="'+a.img+'" alt="'+a.name+'" class="head-md"></p>',g=" mt5"),a.name&&(e='<p class="tc grey9 f12'+g+'">'+a.name+"&nbsp;加入了聊天</p>",g=" mt5"),a.time&&(a.time=Lang.fromNow(parseInt(a.time)),a.time!=b.lastTimeTxt&&(b.lastTimeTxt=a.time,f='<p class="f12 grey9 tc'+g+'">'+a.time+"</p>")),c=d+e+f,c?this.addTxt(c):void 0},transfer:function(a,b,c,d){var e='<p class="tc"><img src="'+a+'" alt="" class="head-md"><span class="ml5 fb f12">'+b+'</span><span class="ml5 mr5 grey f12">转接给了</span><img src="'+c+'" alt="" class="head-md"><span class="ml5 fb f12">'+d+"</span></p>";return this.addTxt(e)},inputMsg:function(a,b,c){var d='<img src="'+MECHAT.Page.Attr.imgPath+'sending.gif" alt="正在输入" /><span class="ipt-status">正在输入...</span>',e=this.serverMsg(a,d,b,c);return e},inputFoucs:function(a){if(a&&MECHAT.Broswer.get!=MECHAT.Broswer.IE6&&MECHAT.Broswer.get!=MECHAT.Broswer.IE7&&MECHAT.Broswer.get!=MECHAT.Broswer.IE8&&MECHAT.Broswer.get!=MECHAT.Broswer.IE9)try{a&&"hidden"!=a.style.visibility&&"none"!=a.style.display&&1!=a.disabled&&a.focus()}catch(b){}},inputBlur:function(a){if(a&&MECHAT.Broswer.get!=MECHAT.Broswer.IE6&&MECHAT.Broswer.get!=MECHAT.Broswer.IE7&&MECHAT.Broswer.get!=MECHAT.Broswer.IE8&&MECHAT.Broswer.get!=MECHAT.Broswer.IE9)try{a&&"hidden"!=a.style.visibility&&"none"!=a.style.display&&1!=a.disabled&&a.blur()}catch(b){}},moveEnd:function(a,b){if(a&&MECHAT.Broswer.get!=MECHAT.Broswer.IE6&&MECHAT.Broswer.get!=MECHAT.Broswer.IE7&&MECHAT.Broswer.get!=MECHAT.Broswer.IE8&&MECHAT.Broswer.get!=MECHAT.Broswer.IE9)try{var c=a.value.length;if(document.selection){var d=a.createTextRange();d.moveStart("character",c),d.collapse(),d.select()}else"number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd&&(a.selectionStart=a.selectionEnd=c);b&&b()}catch(e){}},getToken:function(){MECHAT.Page.Tel.getToken(MECHAT.Page.Attr.api.uptoken,function(a){a.success&&(MECHAT.Page.Attr.file_token=a.token,MECHAT.Page.Attr.file_name=a.filename)},5e3,function(){})},getToken_base64:function(){MECHAT.Page.Tel.getToken(MECHAT.Page.Attr.api.uptoken_base64,function(a){a.success&&(MECHAT.Page.Attr.file_token_base64=a.token)},5e3,function(){})},uploadBack:function(el,pv,data){var self=this;"object"==typeof data||"string"==typeof data&&(data=eval("("+data+")"));var status=Dom.get("span.msg-status",el)[0],send=Dom.get("div.img-sending",el)[0],con=Dom.get("div.msg-con",el)[0];if(data.success){if(Dom.hide(send),pv){var a=Dom.get("a.img-link",con);a&&a[0]&&(a=a[0],a.href=data.path)}else{Dom.addClass(con,"msg-img-con");var a=this.createA(data.path),img=this.createImg(data.path);a.appendChild(img),con.appendChild(a)}status.innerHTML=self.getMsgYes(),MECHAT.Page.Tel.sendMsg(self.source,data,function(){},3e4,function(){})}else status.innerHTML=self.msgNo,pv||(send.innerHTML="图片发送失败")},imgUp:function(a){var b=this,c=new Object,d={btn:a.btn,url:a.url,txt:a.txt,container:a.container||document.body,iframeName:"mechat_imgup_iframe"};c.isPreview=!1,c.fileName=function(a){var b=Lang.getSuffix(a),c=(new Date).getTime(),d=Math.ceil(99*Math.random()+1);return c+"-"+d+"-widget."+b},c.createForm=function(){c.form=Dom.get("form",d.btn)[0],c.form.setAttribute("action",d.url),c.input=Dom.get("input",d.btn)[0],b.input_file=c.input,c.file_key=Dom.get("input.file_key",c.form)[0],c.file_token=Dom.get("input.file_token",c.form)[0];var a;try{a=document.createElement('<iframe name="'+d.iframeName+'" style="display:none;" >')}catch(e){a=document.createElement("iframe")}a.setAttribute("name",d.iframeName),a.setAttribute("style","display:none"),c.iframe=a,d.container.appendChild(c.iframe)},c.fileSize=function(){if(c.input.files&&c.input.files[0]){var a=c.input.files[0].size,b=Math.round(100*a/1024)/100;if(b>5120)return!1}return!0},function(){c.createForm();var a,d,e,f=!1,g=!0;Event.on(c.input,"click",function(a){return g?void 0:(MECHAT.Page.Notice.warmingBar("只能同时上传一张图片",3e3),Event.stopPropagation(a),a.preventDefault&&a.preventDefault(),!1)}),Event.on(c.input,"change",function(){if(MECHAT.Page.Attr.blacklist)return!1;if(!g)return MECHAT.Page.Notice.warmingBar("只能同时上传一张图片",3e3),!1;var h=c.input.value;if(!h)return!1;if(g=!1,h&&Lang.isImg(h))if(d==MECHAT.Page.Attr.file_name&&(MECHAT.Page.Attr.file_name=c.fileName(h)),c.file_key.value=d=MECHAT.Page.Attr.file_name,c.file_token.value=MECHAT.Page.Attr.file_token,b.getToken(),c.fileSize()){if(a=MECHAT.Page.Wrap.imgMsg(),"undefined"!=typeof FileReader){var i=new FileReader;i.onload=function(b){var d=b.target.result;if(window.gIsAndroid&&0!=d.indexOf("data:image/")){var e=sName.split(".").pop().toLowerCase();d=d.replace("base64,","image/"+e+";base64,")}MECHAT.Page.Wrap.imgPreview(a,d),d=null,f=!0,c.form.submit()},i.readAsDataURL(this.files[0])}else c.form.submit();e=setTimeout(function(){b.uploadBack(a,f,{success:!1}),g=!0,c.input.value=""},48e4)}else e&&clearTimeout(e),g=!0,c.input.value="",MECHAT.Page.Notice.warmingBar("图片大小不能超过5MB",3e3);else e&&clearTimeout(e),g=!0,c.input.value="",MECHAT.Page.Notice.warmingBar("只能上传图片",3e3)}),window.MECHAT_IMG_CB=function(h){if(g=!0,c.input.value="",e&&clearTimeout(e),"boolean"==typeof h){var i=MECHAT.Page.Attr.api.upPath+d,j=i&&i.length>0?!0:!1;b.uploadBack(a,f,{success:j,path:i})}else"string"==typeof h&&("413"==h?MECHAT.Page.Notice.warmingBar("图片大小不能超过5MB",3e3):MECHAT.Page.Notice.warmingBar("上传失败了，请重试",3e3),b.uploadBack(a,f,{success:!1}))}}()},upBase64:function(a){if(!(MECHAT.Page.Attr.file_token.length<1)){var b=this,c=MECHAT.Page.Wrap.imgMsg();MECHAT.Page.Wrap.imgPreview(c,a),MECHAT.Page.Tel.base64img(a,MECHAT.Page.Attr.file_token_base64,function(a){if(a.hash&&a.key){var d=MECHAT.Page.Attr.api.upPath+a.key;b.uploadBack(c,!0,{success:!0,path:d})}else b.uploadBack(c,!0,{success:!1});b.getToken_base64()},18e4,function(){b.uploadBack(c,!0,{success:!1})})}},upImgUrl:function(a){var b=this,c=MECHAT.Page.Wrap.imgMsg();MECHAT.Page.Wrap.imgPreview(c,a),b.uploadBack(c,!0,{success:!0,path:a})}};var Leave=function(){var a=new Object;a.source="PC",a.header=Dom.get("#mechat-chat-header")||Dom.get("#mechat-msgbox-header"),a.box=Dom.get("#mechat-message-box"),a.con=Dom.get("#mechat-message-content"),a.phone_txt=Dom.get("#mechat-message-phone"),a.email_txt=Dom.get("#mechat-message-email"),a.btn=Dom.get("#mechat-message-submit"),a.lvtxt=Dom.get("#mechat-lvmsg-txt"),a.isSub=!0,a.s_layout=Dom.get("#mechat-msgsuccess"),a.s_button=Dom.get("#success-btn"),a.s_again=Dom.get("#success-again");var b=a.con.value,c=a.phone_txt.value,d=a.email_txt.value,e=a.btn.innerHTML,f=Color.get(MECHAT.Page.Attr.colorId);return a.setLvmsgTxt=function(){a.lvtxt.innerHTML=MECHAT.Page.Attr.lvmsg_txt,"true"!==MECHAT.Page.Attr.lvmsgChecks.istel&&Dom.hide(a.phone_txt),"true"!==MECHAT.Page.Attr.lvmsgChecks.ismail&&Dom.hide(a.email_txt)},a.setColor=function(b){f=b,"lobegroup"===MECHAT.Page.Attr.custom?(Dom.css(a.header,"background","#fef4ec"),Dom.css(a.btn,"background","#bea257"),Dom.css(a.s_button,"background","#bea257"),Event.on(a.btn,"mouseover",function(){Dom.css(a.btn,"background","#b9932e")}),Event.on(a.btn,"mouseout",function(){Dom.css(a.btn,"background","#bea257")}),Event.on(a.s_button,"mouseover",function(){Dom.css(a.s_button,"background","#b9932e")}),Event.on(a.s_button,"mouseout",function(){Dom.css(a.s_button,"background","#bea257")})):(Dom.css(a.header,"background",b[0]),Dom.css(a.btn,"background",b[0]),Dom.css(a.s_button,"background",b[0]),Event.on(a.btn,"mouseover",function(){Dom.css(a.btn,"background",b[1])}),Event.on(a.btn,"mouseout",function(){Dom.css(a.btn,"background",b[0])}),Event.on(a.s_button,"mouseover",function(){Dom.css(a.s_button,"background",b[1])}),Event.on(a.s_button,"mouseout",function(){Dom.css(a.s_button,"background",b[0])}))},a.show=function(){Dom.show(a.box)},a.hide=function(){Dom.hide(a.box)},a.showSucc=function(){Dom.show(a.s_layout)
},a.hideSucc=function(){Dom.hide(a.s_layout)},a.setTips=function(b,c,d){a.btn.innerHTML=b,c=c||f,d=d||"#fff",Broswer.get()!=Broswer.IE6&&Broswer.get()!=Broswer.IE7&&Broswer.get()!=Broswer.IE8&&(a.btn.style.background=c,a.btn.style.color=d)},a.cb=function(f){f>0?(a.phone_txt.value=c,a.email_txt.value=d,a.con.value=b,a.showSucc()):MECHAT.Page.Notice.create("留言失败，请稍后重试。"),setTimeout(function(){a.isSub=!0,a.setTips(e)},1e3)},a.borderError=function(a,b){a.style.borderColor="#f00",MECHAT.Page.Notice.create(b)},a.borderSucc=function(a){a.style.borderColor="#ccc"},a.isContent=function(){var c=Lang.trim(a.con.value);return c==b||void 0==a.con.defaultValue||c.length<=10?(a.borderError(a.con,"留言不能少于10个字"),!1):c.length>512?(a.borderError(a.con,"留言太长了(512个字符内)"),!1):(a.borderSucc(a.con),c)},a.isPhone=function(b){var b=Lang.trim(a.phone_txt.value);return"true"!==MECHAT.Page.Attr.lvmsgChecks.istel?!0:Lang.isPhone(b)?(a.borderSucc(a.phone_txt),b):Lang.isTell(b)?(a.borderSucc(a.phone_txt),b):(a.borderError(a.phone_txt,"请填写联系电话"),!1)},a.isEmail=function(b){var b=Lang.trim(a.email_txt.value);return"true"!==MECHAT.Page.Attr.lvmsgChecks.ismail?!0:Lang.isEmail(b)?(a.borderSucc(a.email_txt),b):(a.borderError(a.email_txt,"请填写邮箱"),!1)},a.submit=function(){if(!a.isSub)return!1;var b=a.isContent();if(0==b)return!1;var c=a.isPhone();if(0==c)return!1;var d=a.isEmail();if(0==d)return!1;var e={};1!=d&&(e.email=d),1!=c&&(e.phone=c),a.isSub=!1,a.setTips("提交中...","#ccc"),MECHAT.Page.Tel.leaveMsg(a.source,b,e.email,e.phone,function(b){b.success?a.cb(1):a.cb(0)},2e4,function(){a.cb(0),MECHAT.Page.Notice.create("连接超时,请检查网络")})},function(){var b=Color.get(MECHAT.Page.Attr.colorId);a.setColor(b),Event.defautChnage(a.email_txt,"input"),Event.defautChnage(a.phone_txt,"input"),Event.defautChnage(a.con,"input"),Event.on(a.btn,"click",function(){a.submit()}),Event.on(a.s_button,"click",function(){MECHAT.Page.Parent.close(),a.hideSucc()}),Event.on(a.s_again,"click",function(){a.hideSucc()}),window.mechatLeave=function(){a.show()}}(),a};MECHAT.Page.Leave=new Leave,MECHAT.Page.Tel={event:function(source,callback){var attr=MECHAT.Page.Attr,json={mobileid:attr.cookieVal,unitid:attr.unitid},url=_CONFIG.chatHost+attr.api.getEvents;Ajax.get(url,json,{success:function(d){d=eval("("+d+")"),callback(d)}})},chatVisit:function(a,b,c,d){var e=MECHAT.Page.Attr,f={cookie:e.cookieVal,id:e.unitid,unitid:e.unitid,fp:e.fromPage,lp:e.lp,lvt:(new Date).getTime(),chatFlag:!0,localr:e.referrer,source:a},g=_CONFIG.statHost+e.api.chatVisit;Ajax.jsonp(g,f,"mechat_cvcb",{timeout:c,timeoutBack:d}),window.mechat_cvcb=function(a){b(a)}},online:function(source,callback,timeout,timeoutBack){var attr=MECHAT.Page.Attr;if(attr.unitid){var json={unitid:attr.unitid,cookie:attr.cookieVal,nfu:!1,screenRes:attr.screenRes,inviteUs:attr.inviteUs,sendMsgInviteUs:attr.sendMsgInviteUs,time:(new Date).getTime(),from:attr.from,source:source,dial_page:attr.dialPage||attr.fromPage||location.href};"string"==typeof attr.specifyGr&&(json.specifyGr=attr.specifyGr),attr.specifyUs&&(json.specifyUs=attr.specifyUs);var url=_CONFIG.chatHost+attr.api.online;Ajax.post(url,json,{success:function(d){d=eval("("+d+")"),callback(d)},timeout:timeout,timeoutBack:timeoutBack})}},getMsgs:function(source,callback){var attr=MECHAT.Page.Attr,json={usid:MECHAT.Page.uModel.usid,cookie:attr.cookieVal,unitid:attr.unitid,npflag:"",length:10,source:source},url=_CONFIG.chatHost+attr.api.getMsgs;Ajax.post(url,json,{success:function(d){d=eval("("+d+")"),callback(d)}})},poll:function(source,lastMsgId,callback,timeout,timeoutBack){var attr=MECHAT.Page.Attr;lastMsgId=0==lastMsgId?"":lastMsgId;var json={usid:MECHAT.Page.uModel.usid,cookie:attr.cookieVal,unitid:attr.unitid,msgids:lastMsgId||"",nfu:!1,time:(new Date).getTime(),source:source},url=_CONFIG.chatHost+attr.api.poll;Ajax.post(url,json,{success:function(d){d=eval("("+d+")"),callback(d)},timeout:timeout,timeoutBack:timeoutBack})},sendMsg:function(source,con,callback,timeout,timeoutBack){var attr=MECHAT.Page.Attr,json={usid:MECHAT.Page.uModel.usid,unitid:attr.unitid,cookie:attr.cookieVal,time:(new Date).getTime(),nfu:"0",source:source};"string"==typeof con?json.content=con:"object"==typeof con&&(json.content="image",json.type="image",json.path=con.path);var url=_CONFIG.chatHost+attr.api.sendMsg;Ajax.post(url,json,{success:function(datas){var data=eval("("+datas+")");callback&&callback(data)},timeout:timeout,timeoutBack:timeoutBack})},lvmsgVisit:function(a,b){var c=MECHAT.Page.Attr,d={cookie:c.cookieVal,title:"留言",id:c.unitid,unitid:c.unitid,fp:c.fromPage,lp:c.lp,lvt:(new Date).getTime(),lvmsgFlag:!0,localr:c.referrer,source:a};Ajax.jsonp(_CONFIG.chatHost+c.api.lvmsgVisit,d,"mechat_btncb"),window.mechat_btncb=function(a){b&&b(a)}},leaveMsg:function(source,txt,mail,phone,callback,timeout,timeoutBack){var attr=MECHAT.Page.Attr,json={cookie:attr.cookieVal,unitid:attr.unitid,content:txt,email:mail||"",phone:phone||"",referer:attr.referrer,source:source},url=_CONFIG.chatHost+attr.api.leave;Ajax.post(url,json,{success:function(data){data=eval("("+data+")"),callback&&callback(data)},timeout:timeout,timeoutBack:timeoutBack})},getToken:function(uptoken,callback,timeout,timeoutBack){var url=_CONFIG.chatHost+uptoken;Ajax.get(url,{unitid:MECHAT.Page.Attr.unitid},{success:function(d){d=eval("("+d+")"),callback(d)},timeout:timeout,timeoutBack:timeoutBack})},inputting:function(source,txt,callback){var attr=MECHAT.Page.Attr,json={usid:MECHAT.Page.uModel.usid,unitid:attr.unitid,cookie:attr.cookieVal,content:txt,time:(new Date).getTime(),nfu:!1,source:source},url=_CONFIG.chatHost+attr.api.inputting;Ajax.post(url,json,{success:function(datas){var data=eval("("+datas+")")}})},base64img:function(base64,token,callback,timeout,timeoutBack){base64&&base64.length>22&&(base64=base64.substring(22),Ajax.post("https://up.qbox.me/putb64/-1/",base64,{type:"application/octet-stream",author:"UpToken "+token,success:function(data){data=eval("("+data+")"),callback&&callback(data)},timeout:timeout,timeoutBack:timeoutBack}))},metadata:function(a,b){var c=MECHAT.Page.Attr;b.unitid=c.unitid,b.cookie=c.cookieVal,b.source=a;var d=_CONFIG.chatHost+c.api.metadata;Ajax.post(d,b,{success:function(){}})}},MECHAT.Page.Parent={send:function(a){window.parent&&window.parent.postMessage&&(a=Lang.strToObj(a),window.parent.postMessage(a,"*"))},open:function(){this.send("MECHAT-OPEN")},close:function(){this.send("MECHAT-CLOSE")},btnInfo:function(a,b,c,d){this.send({txt:a,color:b,pos:c,style:d})}},MECHAT.Page.Face={emojifacelist:["smile","smiley","laughing","blush","heart_eyes","smirk","flushed","kissing_heart","grin","wink","stuck_out_tongue_winking_eye","stuck_out_tongue","sleeping","worried","expressionless","sweat_smile","joy","cold_sweat","sob","angry","mask","scream","sunglasses","heart","broken_heart","star","anger","exclamation","question","zzz","thumbsup","thumbsdown","ok_hand","punch","v","clap","muscle","pray","skull","trollface"],allemojifacelist:{100:"100",1234:"1234","-1":"-1","+1":"+1","8ball":"8ball",a:"a",ab:"ab",abc:"abc",abcd:"abcd",accept:"accept",aerial_tramway:"aerial_tramway",airplane:"airplane",alarm_clock:"alarm_clock",alien:"alien",ambulance:"ambulance",anchor:"anchor",angel:"angel",anger:"anger",angry:"angry",anguished:"anguished",ant:"ant",apple:"apple",aquarius:"aquarius",aries:"aries",arrow_backward:"arrow_backward",arrow_double_down:"arrow_double_down",arrow_double_up:"arrow_double_up",arrow_down_small:"arrow_down_small",arrow_down:"arrow_down",arrow_forward:"arrow_forward",arrow_heading_down:"arrow_heading_down",arrow_heading_up:"arrow_heading_up",arrow_left:"arrow_left",arrow_lower_left:"arrow_lower_left",arrow_lower_right:"arrow_lower_right",arrow_right_hook:"arrow_right_hook",arrow_right:"arrow_right",arrow_up_down:"arrow_up_down",arrow_up_small:"arrow_up_small",arrow_up:"arrow_up",arrow_upper_left:"arrow_upper_left",arrow_upper_right:"arrow_upper_right",arrows_clockwise:"arrows_clockwise",arrows_counterclockwise:"arrows_counterclockwise",art:"art",articulated_lorry:"articulated_lorry",astonished:"astonished",athletic_shoe:"athletic_shoe",atm:"atm",b:"b",baby_bottle:"baby_bottle",baby_chick:"baby_chick",baby_symbol:"baby_symbol",baby:"baby",back:"back",baggage_claim:"baggage_claim",balloon:"balloon",ballot_box_with_check:"ballot_box_with_check",bamboo:"bamboo",banana:"banana",bangbang:"bangbang",bank:"bank",bar_chart:"bar_chart",barber:"barber",baseball:"baseball",basketball:"basketball",bath:"bath",bathtub:"bathtub",battery:"battery",bear:"bear",bee:"bee",beer:"beer",beers:"beers",beetle:"beetle",beginner:"beginner",bell:"bell",bento:"bento",bicyclist:"bicyclist",bike:"bike",bikini:"bikini",bird:"bird",birthday:"birthday",black_circle:"black_circle",black_joker:"black_joker",black_large_square:"black_large_square",black_medium_small_square:"black_medium_small_square",black_medium_square:"black_medium_square",black_nib:"black_nib",black_small_square:"black_small_square",black_square_button:"black_square_button",blossom:"blossom",blowfish:"blowfish",blue_book:"blue_book",blue_car:"blue_car",blue_heart:"blue_heart",blush:"blush",boar:"boar",boat:"boat",bomb:"bomb",book:"book",bookmark_tabs:"bookmark_tabs",bookmark:"bookmark",books:"books",boom:"boom",boot:"boot",bouquet:"bouquet",bow:"bow",bowling:"bowling",bowtie:"bowtie",boy:"boy",bread:"bread",bride_with_veil:"bride_with_veil",bridge_at_night:"bridge_at_night",briefcase:"briefcase",broken_heart:"broken_heart",bug:"bug",bulb:"bulb",bullettrain_front:"bullettrain_front",bullettrain_side:"bullettrain_side",bus:"bus",busstop:"busstop",bust_in_silhouette:"bust_in_silhouette",busts_in_silhouette:"busts_in_silhouette",cactus:"cactus",cake:"cake",calendar:"calendar",calling:"calling",camel:"camel",camera:"camera",cancer:"cancer",candy:"candy",capital_abcd:"capital_abcd",capricorn:"capricorn",car:"car",card_index:"card_index",carousel_horse:"carousel_horse",cat:"cat",cat2:"cat2",cd:"cd",chart_with_downwards_trend:"chart_with_downwards_trend",chart_with_upwards_trend:"chart_with_upwards_trend",chart:"chart",checkered_flag:"checkered_flag",cherries:"cherries",cherry_blossom:"cherry_blossom",chestnut:"chestnut",chicken:"chicken",children_crossing:"children_crossing",chocolate_bar:"chocolate_bar",christmas_tree:"christmas_tree",church:"church",cinema:"cinema",circus_tent:"circus_tent",city_sunrise:"city_sunrise",city_sunset:"city_sunset",cl:"cl",clap:"clap",clapper:"clapper",clipboard:"clipboard",clock1:"clock1",clock2:"clock2",clock3:"clock3",clock4:"clock4",clock5:"clock5",clock6:"clock6",clock7:"clock7",clock8:"clock8",clock9:"clock9",clock10:"clock10",clock11:"clock11",clock12:"clock12",clock130:"clock130",clock230:"clock230",clock330:"clock330",clock430:"clock430",clock530:"clock530",clock630:"clock630",clock730:"clock730",clock830:"clock830",clock930:"clock930",clock1030:"clock1030",clock1130:"clock1130",clock1230:"clock1230",closed_book:"closed_book",closed_lock_with_key:"closed_lock_with_key",closed_umbrella:"closed_umbrella",cloud:"cloud",clubs:"clubs",cn:"cn",cocktail:"cocktail",coffee:"coffee",cold_sweat:"cold_sweat",collision:"collision",computer:"computer",confetti_ball:"confetti_ball",confounded:"confounded",confused:"confused",congratulations:"congratulations",construction_worker:"construction_worker",construction:"construction",convenience_store:"convenience_store",cookie:"cookie",cool:"cool",cop:"cop",copyright:"copyright",corn:"corn",couple_with_heart:"couple_with_heart",couple:"couple",couplekiss:"couplekiss",cow:"cow",cow2:"cow2",credit_card:"credit_card",crescent_moon:"crescent_moon",crocodile:"crocodile",crossed_flags:"crossed_flags",crown:"crown",cry:"cry",crying_cat_face:"crying_cat_face",crystal_ball:"crystal_ball",cupid:"cupid",curly_loop:"curly_loop",currency_exchange:"currency_exchange",curry:"curry",custard:"custard",customs:"customs",cyclone:"cyclone",dancer:"dancer",dancers:"dancers",dango:"dango",dart:"dart",dash:"dash",date:"date",de:"de",deciduous_tree:"deciduous_tree",department_store:"department_store",diamond_shape_with_a_dot_inside:"diamond_shape_with_a_dot_inside",diamonds:"diamonds",disappointed_relieved:"disappointed_relieved",disappointed:"disappointed",dizzy_face:"dizzy_face",dizzy:"dizzy",do_not_litter:"do_not_litter",dog:"dog",dog2:"dog2",dollar:"dollar",dolls:"dolls",dolphin:"dolphin",door:"door",doughnut:"doughnut",dragon_face:"dragon_face",dragon:"dragon",dress:"dress",dromedary_camel:"dromedary_camel",droplet:"droplet",dvd:"dvd","e-mail":"e-mail",ear_of_rice:"ear_of_rice",ear:"ear",earth_africa:"earth_africa",earth_americas:"earth_americas",earth_asia:"earth_asia",egg:"egg",eggplant:"eggplant",eight_pointed_black_star:"eight_pointed_black_star",eight_spoked_asterisk:"eight_spoked_asterisk",eight:"eight",electric_plug:"electric_plug",elephant:"elephant",email:"email",end:"end",envelope_with_arrow:"envelope_with_arrow",envelope:"envelope",es:"es",euro:"euro",european_castle:"european_castle",european_post_office:"european_post_office",evergreen_tree:"evergreen_tree",exclamation:"exclamation",expressionless:"expressionless",eyeglasses:"eyeglasses",eyes:"eyes",facepunch:"facepunch",factory:"factory",fallen_leaf:"fallen_leaf",family:"family",fast_forward:"fast_forward",fax:"fax",fearful:"fearful",feelsgood:"feelsgood",feet:"feet",ferris_wheel:"ferris_wheel",file_folder:"file_folder",finnadie:"finnadie",fire_engine:"fire_engine",fire:"fire",fireworks:"fireworks",first_quarter_moon_with_face:"first_quarter_moon_with_face",first_quarter_moon:"first_quarter_moon",fish_cake:"fish_cake",fish:"fish",fishing_pole_and_fish:"fishing_pole_and_fish",fist:"fist",five:"five",flags:"flags",flashlight:"flashlight",floppy_disk:"floppy_disk",flower_playing_cards:"flower_playing_cards",flushed:"flushed",foggy:"foggy",football:"football",footprints:"footprints",fork_and_knife:"fork_and_knife",fountain:"fountain",four_leaf_clover:"four_leaf_clover",four:"four",fr:"fr",free:"free",fried_shrimp:"fried_shrimp",fries:"fries",frog:"frog",frowning:"frowning",fu:"fu",fuelpump:"fuelpump",full_moon_with_face:"full_moon_with_face",full_moon:"full_moon",game_die:"game_die",gb:"gb",gem:"gem",gemini:"gemini",ghost:"ghost",gift_heart:"gift_heart",gift:"gift",girl:"girl",globe_with_meridians:"globe_with_meridians",goat:"goat",goberserk:"goberserk",godmode:"godmode",golf:"golf",grapes:"grapes",green_apple:"green_apple",green_book:"green_book",green_heart:"green_heart",grey_exclamation:"grey_exclamation",grey_question:"grey_question",grimacing:"grimacing",grin:"grin",grinning:"grinning",guardsman:"guardsman",guitar:"guitar",gun:"gun",haircut:"haircut",hamburger:"hamburger",hammer:"hammer",hamster:"hamster",hand:"hand",handbag:"handbag",hankey:"hankey",hash:"hash",hatched_chick:"hatched_chick",hatching_chick:"hatching_chick",headphones:"headphones",hear_no_evil:"hear_no_evil",heart_decoration:"heart_decoration",heart_eyes_cat:"heart_eyes_cat",heart_eyes:"heart_eyes",heart:"heart",heartbeat:"heartbeat",heartpulse:"heartpulse",hearts:"hearts",heavy_check_mark:"heavy_check_mark",heavy_division_sign:"heavy_division_sign",heavy_dollar_sign:"heavy_dollar_sign",heavy_exclamation_mark:"heavy_exclamation_mark",heavy_minus_sign:"heavy_minus_sign",heavy_multiplication_x:"heavy_multiplication_x",heavy_plus_sign:"heavy_plus_sign",helicopter:"helicopter",herb:"herb",hibiscus:"hibiscus",high_brightness:"high_brightness",high_heel:"high_heel",hocho:"hocho",honey_pot:"honey_pot",honeybee:"honeybee",horse_racing:"horse_racing",horse:"horse",hospital:"hospital",hotel:"hotel",hotsprings:"hotsprings",hourglass_flowing_sand:"hourglass_flowing_sand",hourglass:"hourglass",house_with_garden:"house_with_garden",house:"house",hurtrealbad:"hurtrealbad",hushed:"hushed",ice_cream:"ice_cream",icecream:"icecream",id:"id",ideograph_advantage:"ideograph_advantage",imp:"imp",inbox_tray:"inbox_tray",incoming_envelope:"incoming_envelope",information_desk_person:"information_desk_person",information_source:"information_source",innocent:"innocent",interrobang:"interrobang",iphone:"iphone",it:"it",izakaya_lantern:"izakaya_lantern",jack_o_lantern:"jack_o_lantern",japan:"japan",japanese_castle:"japanese_castle",japanese_goblin:"japanese_goblin",japanese_ogre:"japanese_ogre",jeans:"jeans",joy_cat:"joy_cat",joy:"joy",jp:"jp",key:"key",keycap_ten:"keycap_ten",kimono:"kimono",kiss:"kiss",kissing_cat:"kissing_cat",kissing_closed_eyes:"kissing_closed_eyes",kissing_heart:"kissing_heart",kissing_smiling_eyes:"kissing_smiling_eyes",kissing:"kissing",koala:"koala",koko:"koko",kr:"kr",lantern:"lantern",large_blue_circle:"large_blue_circle",large_blue_diamond:"large_blue_diamond",large_orange_diamond:"large_orange_diamond",last_quarter_moon_with_face:"last_quarter_moon_with_face",last_quarter_moon:"last_quarter_moon",laughing:"laughing",leaves:"leaves",ledger:"ledger",left_luggage:"left_luggage",left_right_arrow:"left_right_arrow",leftwards_arrow_with_hook:"leftwards_arrow_with_hook",lemon:"lemon",leo:"leo",leopard:"leopard",libra:"libra",light_rail:"light_rail",link:"link",lips:"lips",lipstick:"lipstick",lock_with_ink_pen:"lock_with_ink_pen",lock:"lock",lollipop:"lollipop",loop:"loop",loudspeaker:"loudspeaker",love_hotel:"love_hotel",love_letter:"love_letter",low_brightness:"low_brightness",m:"m",mag_right:"mag_right",mag:"mag",mahjong:"mahjong",mailbox_closed:"mailbox_closed",mailbox_with_mail:"mailbox_with_mail",mailbox_with_no_mail:"mailbox_with_no_mail",mailbox:"mailbox",man_with_gua_pi_mao:"man_with_gua_pi_mao",man_with_turban:"man_with_turban",man:"man",mans_shoe:"mans_shoe",maple_leaf:"maple_leaf",mask:"mask",massage:"massage",meat_on_bone:"meat_on_bone",mega:"mega",melon:"melon",memo:"memo",mens:"mens",metal:"metal",metro:"metro",microphone:"microphone",microscope:"microscope",milky_way:"milky_way",minibus:"minibus",minidisc:"minidisc",mobile_phone_off:"mobile_phone_off",money_with_wings:"money_with_wings",moneybag:"moneybag",monkey_face:"monkey_face",monkey:"monkey",monorail:"monorail",moon:"moon",mortar_board:"mortar_board",mount_fuji:"mount_fuji",mountain_bicyclist:"mountain_bicyclist",mountain_cableway:"mountain_cableway",mountain_railway:"mountain_railway",mouse:"mouse",mouse2:"mouse2",movie_camera:"movie_camera",moyai:"moyai",muscle:"muscle",mushroom:"mushroom",musical_keyboard:"musical_keyboard",musical_note:"musical_note",musical_score:"musical_score",mute:"mute",nail_care:"nail_care",name_badge:"name_badge",neckbeard:"neckbeard",necktie:"necktie",negative_squared_cross_mark:"negative_squared_cross_mark",neutral_face:"neutral_face",new_moon_with_face:"new_moon_with_face",new_moon:"new_moon","new":"new",newspaper:"newspaper",ng:"ng",nine:"nine",no_bell:"no_bell",no_bicycles:"no_bicycles",no_entry_sign:"no_entry_sign",no_entry:"no_entry",no_good:"no_good",no_mobile_phones:"no_mobile_phones",no_mouth:"no_mouth",no_pedestrians:"no_pedestrians",no_smoking:"no_smoking","non-potable_water":"non-potable_water",nose:"nose",notebook_with_decorative_cover:"notebook_with_decorative_cover",notebook:"notebook",notes:"notes",nut_and_bolt:"nut_and_bolt",o:"o",o2:"o2",ocean:"ocean",octocat:"octocat",octopus:"octopus",oden:"oden",office:"office",ok_hand:"ok_hand",ok_woman:"ok_woman",ok:"ok",older_man:"older_man",older_woman:"older_woman",on:"on",oncoming_automobile:"oncoming_automobile",oncoming_bus:"oncoming_bus",oncoming_police_car:"oncoming_police_car",oncoming_taxi:"oncoming_taxi",one:"one",open_book:"open_book",open_file_folder:"open_file_folder",open_hands:"open_hands",open_mouth:"open_mouth",ophiuchus:"ophiuchus",orange_book:"orange_book",outbox_tray:"outbox_tray",ox:"ox","package":"package",page_facing_up:"page_facing_up",page_with_curl:"page_with_curl",pager:"pager",palm_tree:"palm_tree",panda_face:"panda_face",paperclip:"paperclip",parking:"parking",part_alternation_mark:"part_alternation_mark",partly_sunny:"partly_sunny",passport_control:"passport_control",paw_prints:"paw_prints",peach:"peach",pear:"pear",pencil:"pencil",pencil2:"pencil2",penguin:"penguin",pensive:"pensive",performing_arts:"performing_arts",persevere:"persevere",person_frowning:"person_frowning",person_with_blond_hair:"person_with_blond_hair",person_with_pouting_face:"person_with_pouting_face",phone:"phone",pig_nose:"pig_nose",pig:"pig",pig2:"pig2",pill:"pill",pineapple:"pineapple",pisces:"pisces",pizza:"pizza",point_down:"point_down",point_left:"point_left",point_right:"point_right",point_up_2:"point_up_2",point_up:"point_up",police_car:"police_car",poodle:"poodle",poop:"poop",post_office:"post_office",postal_horn:"postal_horn",postbox:"postbox",potable_water:"potable_water",pouch:"pouch",poultry_leg:"poultry_leg",pound:"pound",pouting_cat:"pouting_cat",pray:"pray",princess:"princess",punch:"punch",purple_heart:"purple_heart",purse:"purse",pushpin:"pushpin",put_litter_in_its_place:"put_litter_in_its_place",question:"question",rabbit:"rabbit",rabbit2:"rabbit2",racehorse:"racehorse",radio_button:"radio_button",radio:"radio",rage:"rage",rage1:"rage1",rage2:"rage2",rage3:"rage3",rage4:"rage4",railway_car:"railway_car",rainbow:"rainbow",raised_hand:"raised_hand",raised_hands:"raised_hands",raising_hand:"raising_hand",ram:"ram",ramen:"ramen",rat:"rat",recycle:"recycle",red_car:"red_car",red_circle:"red_circle",registered:"registered",relaxed:"relaxed",relieved:"relieved",repeat_one:"repeat_one",repeat:"repeat",restroom:"restroom",revolving_hearts:"revolving_hearts",rewind:"rewind",ribbon:"ribbon",rice_ball:"rice_ball",rice_cracker:"rice_cracker",rice_scene:"rice_scene",rice:"rice",ring:"ring",rocket:"rocket",roller_coaster:"roller_coaster",rooster:"rooster",rose:"rose",rotating_light:"rotating_light",round_pushpin:"round_pushpin",rowboat:"rowboat",ru:"ru",rugby_football:"rugby_football",runner:"runner",running_shirt_with_sash:"running_shirt_with_sash",running:"running",sa:"sa",sagittarius:"sagittarius",sailboat:"sailboat",sake:"sake",sandal:"sandal",santa:"santa",satellite:"satellite",satisfied:"satisfied",saxophone:"saxophone",school_satchel:"school_satchel",school:"school",scissors:"scissors",scorpius:"scorpius",scream_cat:"scream_cat",scream:"scream",scroll:"scroll",seat:"seat",secret:"secret",see_no_evil:"see_no_evil",seedling:"seedling",seven:"seven",shaved_ice:"shaved_ice",sheep:"sheep",shell:"shell",ship:"ship",shipit:"shipit",shirt:"shirt",shit:"shit",shoe:"shoe",shower:"shower",signal_strength:"signal_strength",six_pointed_star:"six_pointed_star",six:"six",ski:"ski",skull:"skull",sleeping:"sleeping",sleepy:"sleepy",slot_machine:"slot_machine",small_blue_diamond:"small_blue_diamond",small_orange_diamond:"small_orange_diamond",small_red_triangle_down:"small_red_triangle_down",small_red_triangle:"small_red_triangle",smile_cat:"smile_cat",smile:"smile",smiley_cat:"smiley_cat",smiley:"smiley",smiling_imp:"smiling_imp",smirk_cat:"smirk_cat",smirk:"smirk",smoking:"smoking",snail:"snail",snake:"snake",snowboarder:"snowboarder",snowflake:"snowflake",snowman:"snowman",sob:"sob",soccer:"soccer",soon:"soon",sos:"sos",sound:"sound",space_invader:"space_invader",spades:"spades",spaghetti:"spaghetti",sparkle:"sparkle",sparkler:"sparkler",sparkles:"sparkles",sparkling_heart:"sparkling_heart",speak_no_evil:"speak_no_evil",speaker:"speaker",speech_balloon:"speech_balloon",speedboat:"speedboat",squirrel:"squirrel",star:"star",star2:"star2",stars:"stars",station:"station",statue_of_liberty:"statue_of_liberty",steam_locomotive:"steam_locomotive",stew:"stew",straight_ruler:"straight_ruler",strawberry:"strawberry",stuck_out_tongue_closed_eyes:"stuck_out_tongue_closed_eyes",stuck_out_tongue_winking_eye:"stuck_out_tongue_winking_eye",stuck_out_tongue:"stuck_out_tongue",sun_with_face:"sun_with_face",sunflower:"sunflower",sunglasses:"sunglasses",sunny:"sunny",sunrise_over_mountains:"sunrise_over_mountains",sunrise:"sunrise",surfer:"surfer",sushi:"sushi",suspect:"suspect",suspension_railway:"suspension_railway",sweat_drops:"sweat_drops",sweat_smile:"sweat_smile",sweat:"sweat",sweet_potato:"sweet_potato",swimmer:"swimmer",symbols:"symbols",syringe:"syringe",tada:"tada",tanabata_tree:"tanabata_tree",tangerine:"tangerine",taurus:"taurus",taxi:"taxi",tea:"tea",telephone_receiver:"telephone_receiver",telephone:"telephone",telescope:"telescope",tennis:"tennis",tent:"tent",thought_balloon:"thought_balloon",three:"three",thumbsdown:"thumbsdown",thumbsup:"thumbsup",ticket:"ticket",tiger:"tiger",tiger2:"tiger2",tired_face:"tired_face",tm:"tm",toilet:"toilet",tokyo_tower:"tokyo_tower",tomato:"tomato",tongue:"tongue",top:"top",tophat:"tophat",tractor:"tractor",traffic_light:"traffic_light",train:"train",train2:"train2",tram:"tram",triangular_flag_on_post:"triangular_flag_on_post",triangular_ruler:"triangular_ruler",trident:"trident",triumph:"triumph",trolleybus:"trolleybus",trollface:"trollface",trophy:"trophy",tropical_drink:"tropical_drink",tropical_fish:"tropical_fish",truck:"truck",trumpet:"trumpet",tshirt:"tshirt",tulip:"tulip",turtle:"turtle",tv:"tv",twisted_rightwards_arrows:"twisted_rightwards_arrows",two_hearts:"two_hearts",two_men_holding_hands:"two_men_holding_hands",two_women_holding_hands:"two_women_holding_hands",two:"two",u6e80:"u6e80",u7a7a:"u7a7a",u55b6:"u55b6",u5272:"u5272",u5408:"u5408",u6307:"u6307",u6708:"u6708",u6709:"u6709",u7121:"u7121",u7533:"u7533",u7981:"u7981",uk:"uk",umbrella:"umbrella",unamused:"unamused",underage:"underage",unicode:"unicode",unlock:"unlock",up:"up",us:"us",v:"v",vertical_traffic_light:"vertical_traffic_light",vhs:"vhs",vibration_mode:"vibration_mode",video_camera:"video_camera",video_game:"video_game",violin:"violin",virgo:"virgo",volcano:"volcano",vs:"vs",walking:"walking",waning_crescent_moon:"waning_crescent_moon",waning_gibbous_moon:"waning_gibbous_moon",warning:"warning",watch:"watch",water_buffalo:"water_buffalo",watermelon:"watermelon",wave:"wave",wavy_dash:"wavy_dash",waxing_crescent_moon:"waxing_crescent_moon",waxing_gibbous_moon:"waxing_gibbous_moon",wc:"wc",weary:"weary",wedding:"wedding",whale:"whale",whale2:"whale2",wheelchair:"wheelchair",white_check_mark:"white_check_mark",white_circle:"white_circle",white_flower:"white_flower",white_large_square:"white_large_square",white_medium_small_square:"white_medium_small_square",white_medium_square:"white_medium_square",white_small_square:"white_small_square",white_square_button:"white_square_button",wind_chime:"wind_chime",wine_glass:"wine_glass",wink:"wink",wolf:"wolf",woman:"woman",womans_clothes:"womans_clothes",womans_hat:"womans_hat",womens:"womens",worried:"worried",wrench:"wrench",x:"x",yellow_heart:"yellow_heart",yen:"yen",yum:"yum",zap:"zap",zero:"zero",zzz:"zzz"},faceSpan:function(a,b,c){var d;c=c||"emoji-face";try{d=document.createElement('<span title="'+a+'" class="emoji-face" style="background-position:'+b.x+"px "+b.y+'px;">')}catch(e){d=document.createElement("span"),d.setAttribute("class",c),d.setAttribute("title",a),d.setAttribute("style","background-position:"+b.x+"px "+b.y+"px")}return d},converEmojiByPc:function(a){var b,c,d,e,f=this,g=!1,h=25,i=Broswer.get(),j=0;i!=Broswer.IE6&&i!=Broswer.IE7&&i!=Broswer.IE8&&(h=18,j=-1);for(var k=0,l=f.emojifacelist.length;l>k;k++)b=f.emojifacelist[k],c="["+b+"]",a.indexOf(c)>=0&&(d=f.getPositioin(k,h),d.x+=j,d.y+=j,e=f.faceSpan(b,d,"mini-emoji-face"),a=a.replace(c,e.outerHTML),g=!0);return g||(a=f.converEmoji(a)),a},converEmoji:function(a){var b,c,d=this;for(c in d.allemojifacelist)b=new RegExp("\\["+c+"\\]","g"),a=a.replace(b,'<img src="'+MECHAT.Page.Attr.imgPath+"emojis/"+d.allemojifacelist[c]+'.png" width="17px" height="17px" style="vertical-align:top;" />');return a},getPositioin:function(a,b){var c=a%4,d=Math.floor(a/4);return b=b||25,c=-(c*b),d=-(d*b),{x:c,y:d}}},MECHAT.Page.Contr=function(a){var b=new Object,c=MECHAT.Page,d=MECHAT.Page.CommonCK,e=a.source;MECHAT.Page.Attr.panel=a;var f=["MECHAT_LineMark",(new Date).getTime()],g={isChatVisit:!1,isOnline:!1},h={visit:!1,online:!1,getMsgs:!1,getEvents:!1,isOtherLine:!1,isTrigger:!1,lvmsgVisit:!1},i=0,j=0,k=new Array,l=new Array,m=null;return b.trigger=function(){h.isTrigger||(h.isTrigger=!0,h.getMsgs=!1,h.getEvents=!1,b.start())},b.start=function(){var a=d.read(f[0]);"string"==typeof a?(h.visit=!0,b.online()):b.chatVisit()},b.setLineMark=function(){d.save(f[0],f[1])},b.mRS=function(a){for(var b=[],c=0,d=0;a>d;d++)c=Math.floor(10*Math.random()),b.push(c.toString());return b.join("")},b.cookieCode=function(){return"006600"+(new Date).getTime().toString()+b.mRS(5)},b.isOnline=function(){c.uModel.setProperty(c.uModel.read());var a=!1,b=(new Date).getTime();return c.uModel.usid&&c.uModel.utime<b&&(a=!0),a},b.chatVisit=function(){return h.visit?(b.online(),void 0):(c.Tel.chatVisit(e,function(a){a.success&&(a.cookie&&(c.Attr.cookieVal=a.cookie),b.online(),h.visit=!0)},3e3,function(){h.online||b.online()}),void 0)},b.online=function(){"MB"==e&&(c.Synch.isCheck=!1),c.Attr.cookieVal||(c.Attr.cookieVal=b.cookieCode()),d.save(c.Attr.cookieKey,c.Attr.cookieVal),h.online||g.isOnline||(c.Parent.send("MECHAT-METADATA"),b.setLineMark(),g.isOnline=!0,a.lineInit(),c.Loading.show(),c.Tel.online(e,function(d){c.Loading.hide(),(c.Attr.username||c.Attr.remark||c.Attr.tel||c.Attr.email)&&MECHAT.Page.Tel.metadata(e,{appNickName:c.Attr.username,comment:c.Attr.remark,tel:c.Attr.tel,email:c.Attr.email}),b.readLvmsg({lvmsg_txt:d.lvmsgNote,ismail:d.lvmsgChecks.ismail,istel:d.lvmsgChecks.istel,ismsn:d.lvmsgChecks.ismsn,isqq:d.lvmsgChecks.isqq}),d.success?(h.online=!0,d.utime=(new Date).getTime(),c.uModel.setProperty(d),c.uModel.save(d),a.setInitInfo(c.uModel),MECHAT.Page.Synch.save("online",d),MECHAT.Page.FootTips.disabled(!1),d.urspmsg&&d.ursptime&&(c.Attr.urspmsg=d.urspmsg,c.Attr.ursptime=parseInt(d.ursptime)),b.getMsgs()):(c.Synch.isCheck=!1,b.lvmsgVisit(),a.leaveTips(),a.lineError())},3e4,function(){g.isOnline=!1,MECHAT.Page.Notice.warmingBar(a.lineOutTxt),a.lineOut(),c.Loading.hide(),MECHAT.Page.FootTips.disabled(!0)}))},b.getMsgs=function(){h.getMsgs?b.getEvents():c.Tel.getMsgs(e,function(a){a.success&&(h.getMsgs=!0,k=a.msgs,b.getEvents())})},b.getEvents=function(){h.getEvents?b.poll():c.Tel.event(b.source,function(c){if(c.success){h.getEvents=!0;for(var d=[],e=0,f=0,g=c.events.length;g>f;f++){var i=c.events[f];"invite"==i.type&&parseInt(i.createdTime)-e>12e4&&(d.push(i),e=parseInt(i.createdTime))}Array.prototype.push.apply(k,d),function(){for(var a,b=k.length,c=0;b>c;c++)if("alloc_us"==k[c].type){a=parseInt(k[c].createdTime);break}if(a)for(var c=0;b>c;c++)"us_welcome"==k[c].type&&(k[c].createdTime=a+c+1)}(),k.sort(function(a,b){return a.createdTime>b.createdTime}),b.disMsg(k),setTimeout(function(){a.getToken(),a.getToken_base64()},2e3),b.poll()}})},b.poll=function(){c.Attr.blacklist||c.Tel.poll(e,i,function(d){if(d.success){var e=d.msgs;if(e[0]&&(e=e[0],e.type)){if("us_redirect"==e.type){var f=e.userver;f.uname||(f.uname=c.uModel.uname),a.transfer(c.uModel.usavatar,c.uModel.usname,f.usavatar,f.usname),c.uModel.setProperty(f),c.uModel.save(f),a.setInitInfo(),MECHAT.Page.Synch.save("redirect",e),e._id&&(i=e._id)}else{if("us_normal"==e.type){if(e.originId&&j!=e.fromId){var g={name:e.fromName,time:e.createdTime};j=e.fromId,a.tipsMsg(g)}MECHAT.Page.Synch.save("us_normal",e)}b.disMsg(e)}setTimeout(b.poll,100)}}else d.code&&1==d.code&&(c.Attr.blacklist=!0,a.leaveTips("您已被客服拉进黑名单，系统将关闭对话"),b.setBlacklist(),MECHAT.Page.Synch.save("blacklist",{}))},3e4,function(){setTimeout(b.poll,100)})},b.lvmsgVisit=function(){h.lvmsgVisit||(h.lvmsgVisit=!0,c.Tel.lvmsgVisit(e),c.Parent.send("MECHAT-METADATA"))},b.metadata=function(a){if(a){var c=1e4;b.meta_time||(b.meta_time=(new Date).getTime()-c);var d=(new Date).getTime();d-b.meta_time<c?(b.meta_timeOut&&clearTimeout(b.meta_timeOut),b.meta_timeOut=setTimeout(function(){b.metadata(a)},c)):(b.meta_time=d,MECHAT.Page.Tel.metadata(e,a))}},b.setBlacklist=function(){c.Attr.blacklist=!0,MECHAT.Page.Notice.errorBar("您已被客服拉进黑名单，系统将关闭对话"),MECHAT.Page.FootTips.disabled(!0),a.inputOnBlur()},b.disMsg=function(c){if(c instanceof Array)for(var d=0,e=c.length;e>d;d++){var f=c[d];b.disMsg(f)}else{if(c._id){if(i=c._id,l.in_array(c._id))return;
l.push(c._id)}switch(c.type){case"redirect":a.transfer(c.avatar,c.usname,c.toavatar,c.toname);break;case"alloc_us":case"invite":var g={img:c.avatar,name:c.usname,time:c.createdTime};a.tipsMsg(g);break;default:a.readMsg(c)}}},b.readLvmsg=function(a){c.Attr.lvmsg_txt=a.lvmsg_txt||c.Attr.lvmsg_txt,c.Attr.lvmsgChecks.ismail=a.ismail||c.Attr.lvmsgChecks.ismail,c.Attr.lvmsgChecks.isqq=a.isqq||c.Attr.lvmsgChecks.isqq,c.Attr.lvmsgChecks.istel=a.istel||c.Attr.lvmsgChecks.istel,a.cookie&&(c.Attr.cookieVal=a.cookie),a.dialPage&&(c.Attr.dialPage=a.dialPage),c.Leave.setLvmsgTxt()},b.setInputFoucs=function(){m&&clearInterval(m),m=setInterval(function(){h.online&&(a.inputOnfoucs(),clearInterval(m))},300)},function(){c.Parent.send("MECHAT-READY"),window.mechatReStart=function(){MECHAT.Page.Notice.hideBar(),b.start()},Event.on(window,"message",function(d){var e=Lang.strToObj(d.data);if("string"==typeof e);else if("object"==typeof e&&e.mechat)switch(e.mechat){case"MECHAT-LAYOUT-SHOW":b.setInputFoucs();break;case"MECHAT-CHAT-HANDS":e.dialPage&&(c.Attr.dialPage=e.dialPage);break;case"MECHAT-CHAT-SHOW":if(b.readLvmsg(e),e.cookie&&(MECHAT.Page.Attr.cookieVal=e.cookie),void 0!=typeof e.hasOnlineUServer&&("false"==e.hasOnlineUServer||0==e.hasOnlineUServer))return b.lvmsgVisit(),a.lineError(),void 0;b.start(),b.setInputFoucs();break;case"MECHAT_VISIT_MSG":MECHAT.Page.uModel.setProperty(e),e.picurl&&(e.content=e.picurl),e.fromId&&(c.Attr.sendMsgInviteUs=e.fromId),b.readLvmsg(e),a.setInitInfo(),e.cookie&&(MECHAT.Page.Attr.cookieVal=e.cookie),b.trigger(),b.setInputFoucs();break;case"MECHAT-METADATA":var f=MECHAT.Page.MetadatModel.filterProperty(e);b.metadata(f)}}),setTimeout(function(){MECHAT.Page.Synch.check(function(d){if(d.type){if(d.msgid){if(d.msgid==i)return;i=d.msgid}switch(d.type){case"blacklist":b.setBlacklist();break;case"redirect":var e=c.uModel.read();e.usid!=c.uModel.usid&&(a.transfer(c.uModel.usavatar,c.uModel.usname,e.usavatar,e.usname),c.uModel.setProperty(e),a.setInitInfo());break;case"online":case"invite":var e=c.uModel.read();if(e.usid!=c.uModel.usid){c.uModel.setProperty(e),a.setInitInfo();var f={img:c.uModel.usavatar,name:c.uModel.usname};a.tipsMsg(f)}break;default:a.readMsg(d)}}})},1e4)}(),b}}(),function(){var a=MECHAT.Dom,b=MECHAT.Page,c=MECHAT.Lang,d=MECHAT.Color,e=MECHAT.Event,f=MECHAT.Broswer,g=b.Attr.colorDf;d.get&&(g=d.get(b.Attr.colorId));var h={is_vocie:!0};!function(){var c={header:a.get("#header"),head:a.get("#oper-head"),company:a.get("#oper-company"),name_panel:a.get("#oper-name"),btn_vocie:a.get("#J_vocie"),btn_max:a.get("#J_max"),btn_min:a.get("#J_min"),isShow:!1,showInfo:function(){a.show(this.s_arrow),a.show(this.s_info),this.isShow=!0},hideInfo:function(){a.hide(this.s_arrow),a.hide(this.s_info),this.isShow=!1},setInfo:function(c){var d=c.usavatar;this.head.setAttribute("src",d),this.name.innerHTML=c.usname,this.name.setAttribute("title",c.usname),c.uname&&(this.company.innerHTML=c.uname),this.s_info.innerHTML="",this.setContact("tel",c.ustel||c.utel),this.setContact("mail",c.usemail),this.setContact("qq",c.usqq),this.s_info.innerHTML,"lobegroup"===b.Attr.custom&&(document.getElementById("agentName").innerHTML=c.usname,document.getElementById("mobileInfo").innerHTML=c.ustel||c.utel,document.getElementById("mailBtn").href="mailto:"+c.usemail,document.getElementById("mailInfo").innerHTML=c.usemail),a.hide(this.info_btn)},lineInit:function(){this.name.innerHTML="请稍等",this.company.innerHTML="正在连接..."},lineOut:function(){this.name.innerHTML="暂无连接",this.company.innerHTML="连接超时，请检查网络"},setContact:function(a,b){var c=document.createElement("a"),d='<i class="icon mr10 ';switch(a){case"tel":d+="icon-phone",c.setAttribute("href","tel:"+b),c.setAttribute("title","点击拨打电话");break;case"mail":d+="icon-mail",c.setAttribute("href","mailto:"+b),c.setAttribute("title","点击发送邮件");break;case"qq":d+="icon-qq",c.setAttribute("href","tencent://message/?uin="+b),c.setAttribute("title","使用QQ聊天")}b&&(d+='"></i><span>'+b+"</span>",c.setAttribute("target","_blank"),c.innerHTML=d,this.s_info.appendChild(c))},setColor:function(b){a.css(this.header,"background",b)}};c.name=a.get("span.white",c.name_panel)[0],c.info_btn=a.get("span.icon-contact",c.name_panel)[0],c.s_arrow=a.get("span.arrow-tc",c.name_panel)[0],c.s_info=a.get("span.contact",c.name_panel)[0],c.s_vocie=a.get("span",c.btn_vocie)[0],function(){"lobegroup"!==b.Attr.custom&&(c.setColor(g[0]),e.on(c.info_btn,"click",function(a){c.isShow?c.hideInfo():c.showInfo(),e.stopPropagation(a)})),"max"==b.Attr.win&&(a.hide(c.btn_max),a.hide(c.btn_min)),e.on(c.btn_max,"click",function(){b.Parent.close();var a=MECHAT.Page.Attr.chatHtml+"?unitid="+b.Attr.unitid+"&color="+b.Attr.colorId+"&cookie="+b.Attr.cookieVal+"&win=max&ol=auto";"lobegroup"===b.Attr.custom&&(a=MECHAT.Page.Attr.lobegroupHtml+"?unitid="+b.Attr.unitid+"&color="+b.Attr.colorId+"&cookie="+b.Attr.cookieVal+"&win=max&ol=auto"+"&custom=lobegroup"),window.open(a,"_blank","toolbars=0,scrollbars=0,location=0,status=0,menubars=0,resizable=0,width=400,height=650")}),e.on(c.btn_vocie,"click",function(){h.is_vocie=h.is_vocie?!1:!0;var a="icon icon-mute";h.is_vocie&&(a="icon icon-voice"),f.isIE()?c.s_vocie.className=a:c.s_vocie.setAttribute("class",a)}),e.on(c.btn_min,"click",function(){b.Parent.close()})}(),h.Header=c}(),function(){h.FacePanel=function(d){var f=new Object;f.panel=a.get("#face-con"),f.ul=a.get("ul",f.panel)[0],f.btn=a.get("#face-btn");var h=!1;return f.createLi=function(a){var b;try{b=document.createElement('<li title="'+a+'">')}catch(c){b=document.createElement("li"),b.setAttribute("title",a)}return b},f.createFace=function(){var g,h,i,j,k=b.Face;f.ul.innerHTML="";for(var l=0,m=k.emojifacelist.length;m>l;l++)g=k.emojifacelist[l],h=f.createLi(g),j=k.getPositioin(l),i=k.faceSpan(g,j),h.appendChild(i),c.isMac()&&a.css(h,"margin","1px"),f.ul.appendChild(h),e.on(h,"click",function(a){a=window.event||a,f.close();var b="smile";a.srcElement?b=a.srcElement.title:this.getAttribute&&(b=this.getAttribute("title")),d(b)})},f.close=function(){h=!1,a.hide(f.panel)},f.open=function(){h=!0,a.show(f.panel)},f.setColor=function(b){a.css(f.panel,"box-shadow","0 0 8px "+b)},function(){e.on(f.panel,"mousewheel",function(a){var b=a.wheelDelta?a.wheelDelta:10*-a.detail;return f.panel.scrollTop=f.panel.scrollTop-b,a.preventDefault&&a.preventDefault(),!1}),"lobegroup"!==b.Attr.custom&&f.setColor(g[0]),e.on(f.btn,"click",function(a){h?f.close():f.open(),e.stopPropagation(a)}),"lobegroup"===b.Attr.custom?f.createFace():setTimeout(function(){f.createFace()},5e3)}(),f}}(),function(){var c=function(){var c=b.Leave;return c.btn_min=a.get("a.oper_minbtn",c.box)[0],function(){"max"==b.Attr.win&&a.hide(c.btn_min),e.on(c.btn_min,"click",function(){b.Parent.close()})}(),c};h.Leave=new c}(),function(){var i=function(){var i=b.Wrap;i.input=a.get("#MC_input"),i.submit=a.get("#MC_submit"),i.sound=a.get("#MC_sound"),i.btn_imgUp=a.get("#MC_imgUp"),i.paste_el=a.get("#paste_img"),i.input.defautValue=i.input.value;var j,k=null,l=null,m=-1;return i.setInitInfo=function(){h.Header.setInfo(b.uModel);var a=d.get(b.Attr.colorId);i.setColor(a),"lobegroup"!==b.Attr.custom&&h.Header.setColor(a[0]),setTimeout(i.createFace,1500)},i.setColor=function(c){"lobegroup"!==b.Attr.custom&&(a.css(i.submit,"background",c[0]),a.css(i.submit,"color","#fff"),e.on(i.submit,"mouseover",function(){a.css(i.submit,"background",c[1])}),e.on(i.submit,"mouseout",function(){a.css(i.submit,"background",c[0])}))},i.updateInfo=function(){h.Header.setInfo(b.uModel)},i.lineError=function(){h.Leave.show(),b.Parent.send("MECHAT-USERVER")},i.lineInit=function(){h.Header.lineInit()},i.lineOut=function(){h.Header.lineOut()},i.sendMsg=function(){var a=c.trim(i.input.value)||"";a!=i.input.defautValue&&(a.length>0&&a.length<=512?(i.input.value="",i.input.focus(),i.sendClientMsg(a)):a.length>512&&b.Notice.warmingBar("内容太长，不要超过512个字符",3e3))},i.soundPlay=function(){i.sdPlay&&clearTimeout(i.sdPlay);var a=f.get();i.sound.innerHTML=f.isIE()?'<object width="0" height="0" classid="clsid:22D6F312-B0F6-11D0-94AB-0080C74C7E95"><param name="AutoStart" value="1" /><param name="Src" value="'+MECHAT.Page.Attr.audioPath+'msg.wav" /></object>':a==f.Chrome||a==f.Firefox||a==f.Safari?'<audio src="'+MECHAT.Page.Attr.audioPath+'msg.wav" autoplay="autoplay" type="audio/mp3" hidden="true"></audio>':a==f.Opera?'<embed src="'+MECHAT.Page.Attr.audioPath+'msg.wav" hidden="true" loop="false"><noembed><bgsounds src="'+MECHAT.Page.Attr.audioPath+'msg.wav"></noembed>':'<embed src="'+MECHAT.Page.Attr.audioPath+'msg.wav" type="audio/mp3" hidden="true" loop="false" mastersound></embed>',i.sdPlay=setTimeout(function(){i.sound.innerHTML=""},3e3)},i.createFace=function(){"undefined"==typeof j&&(j=new h.FacePanel(function(a){var b="["+a+"]";m=-1,i.addText(b),i.inputFoucs(i.input)}))},i.addText=function(a){if(a&&!(a.length<0)){var b=i.input.value;if(b=b.replace(i.input.defautValue,""),m>-1){var c=b.substring(0,m),d=b.substring(m,b.length),e=a.length,f=c.length;i.input.value=c+a+d,i.setCaretPosition(e+f)}else i.input.value=b+a}},i.inputOnfoucs=function(){i.inputFoucs(i.input)},i.inputOnBlur=function(){i.inputBlur(i.input)},i.getCursortPosition=function(){if(document.selection){var a=document.selection.createRange();a.moveStart("character",-i.input.value.length),m=a.text.length}else(i.input.selectionStart||"0"==i.input.selectionStart)&&(m=i.input.selectionStart)},i.setCaretPosition=function(a){if(i.input.setSelectionRange)i.input.focus(),i.input.setSelectionRange(a,a);else if(i.input.createTextRange){var b=i.input.createTextRange();b.collapse(!0),b.moveEnd("character",a),b.moveStart("character",a),b.select()}},i.arrivedNotice=function(a){"arrived"==a&&(h.is_vocie&&i.soundPlay(),b.Parent.open())},i.readMsg=function(d){var e=this;switch(d.type){case"unit_welcome":d.note&&(d.content='<a href="'+c.httpReplace(d.note)+'" target="_blank" title="点击查看活动详情">'+d.content+"</a>");case"us_welcome":case"us_normal":e.serverMsg(d.fromName,d.content,k,d.createdTime),k=null,l&&clearTimeout(l),e.arrivedNotice(d.status);break;case"us_image":e.serverImgMsg(d.fromName,d.picUrl,k,d.createdTime),k=null,l&&clearTimeout(l),e.arrivedNotice(d.status);break;case"mb_normal":e.clientMsg(d.content,null,d.createdTime);break;case"us_inputting":var f=(new Date).getTime();f-d.createdTime<2e3&&(k=e.inputMsg(d.fromName,k),l=setTimeout(function(){if(null!=k){clearTimeout(l);var b=k.innerHTML;b&&b.indexOf(alt="正在输入")>0&&(a.hide(k),k=null)}},8e3));break;case"mb_image":e.imgMsg(d.picUrl,e.msgYes,d.createdTime);break;case"visit_invite":b.Parent.open()}},i.inputting=function(){var a,b="",c=function(){var a=i.input.value;a=a==i.input.defautValue?"":a,a!=b&&(i.clientInputting(a),b=a)},d=function(){a=setInterval(function(){c()},3e3)};e.on(i.input,"focus",function(){return a||setTimeout(d,2e3),!1}),e.on(i.input,"blur",function(){clearInterval(a),a=null,c()})},i.chromeImgReader=function(a){var b=new Image;b.src=a,i.wrap.appendChild(b)},i.imgReader=function(){var b=i.paste_el.innerHTML;if(b&&b.length>0)if(b.indexOf("<img")>-1){var d=a.get("img",i.paste_el)[0],e=d.getAttribute("src")||"";e.indexOf("data:image/png;base64")>-1?i.upBase64(e):c.isImg(e)&&i.upImgUrl(e)}else i.addText(b);i.paste_el.innerHTML="",i.inputOnfoucs()},i.ChromePaste=function(){e.on(i.input,"paste",function(a){var b=a.clipboardData;if(b&&b.items){items=b.items;for(var c=0,d=items.length;d>c;c++)item=items[c],item.type.match(/^image\//)&&(reader=new FileReader,reader.onload=function(a){var b=a.target.result;b.indexOf("data:image/png;base64")>-1&&i.upBase64(b)},reader.readAsDataURL(item.getAsFile()))}})},i.IEFFPaste=function(){var a=f.get();a!=f.IE6&&a!=f.IE7&&a!=f.IE8&&a!=f.IE9&&a!=f.IE10&&a!=f.Safari&&(e.on(i.input,"keydown",function(a){(a.ctrlKey&&86===a.keyCode||a.metaKey&&86===a.keyCode)&&(i.getCursortPosition(),i.paste_el.setAttribute("contenteditable",!0),i.paste_el.focus())}),e.on(i.paste_el,"paste",function(a){var b=a.clipboardData||window.clipboardData;if(b){var c=b.getData("Text");null!=c&&c.length>0?(window.clipboardData||i.addText(c),i.inputOnfoucs()):setTimeout(function(){i.imgReader()},1)}else i.inputOnfoucs()}))},i.pasteImg=function(){navigator.userAgent.indexOf("Chrome")>-1?i.ChromePaste():i.IEFFPaste()},function(){i.setColor(g),e.defautChnage(i.input,"input",function(){h.Header.hideInfo(),j&&j.close()}),e.on(i.submit,"click",function(){i.sendMsg()});var a=f.get();e.on(i.input,"keydown",function(b){"13"==b.keyCode&&(i.sendMsg(),a==f.IE6?i.sendMsg():a==f.IE7||a==f.IE8?window.event.returnValue=!1:b.preventDefault())}),i.inputting(),i.pasteImg();var c=b.Attr.api.upload;i.imgUp({btn:i.btn_imgUp,url:c,txt:i.input}),e.on(i.wrap,"mousewheel",function(a){var b=a.wheelDelta?a.wheelDelta:10*-a.detail;return i.wrap.scrollTop=i.wrap.scrollTop-b,a.preventDefault&&a.preventDefault(),!1}),e.on(document.body,"click",function(){h.Header.hideInfo(),j&&j.close()})}(),i};h.Panel=new i}(),window.onload=function(){var a=new b.Contr(h.Panel);"auto"===MECHAT.Page.Attr.ol&&a.start()}}();